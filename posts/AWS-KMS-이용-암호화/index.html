<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="AWS KMS 이용 암호화" /><meta property="og:locale" content="en_US" /><meta name="description" content="고객관리형키 KMS 키로 암호화 적용" /><meta property="og:description" content="고객관리형키 KMS 키로 암호화 적용" /><link rel="canonical" href="https://hyunhyun.github.io/posts/AWS-KMS-%EC%9D%B4%EC%9A%A9-%EC%95%94%ED%98%B8%ED%99%94/" /><meta property="og:url" content="https://hyunhyun.github.io/posts/AWS-KMS-%EC%9D%B4%EC%9A%A9-%EC%95%94%ED%98%B8%ED%99%94/" /><meta property="og:site_name" content="HyunHyun’s BLOG" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-07-21T00:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="AWS KMS 이용 암호화" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="S2Q4nwJjgxAbN61nSOPVNdKcbH6lPffUjoqeFLbKIBE" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-07-21T15:42:08+09:00","datePublished":"2023-07-21T00:00:00+09:00","description":"고객관리형키 KMS 키로 암호화 적용","headline":"AWS KMS 이용 암호화","mainEntityOfPage":{"@type":"WebPage","@id":"https://hyunhyun.github.io/posts/AWS-KMS-%EC%9D%B4%EC%9A%A9-%EC%95%94%ED%98%B8%ED%99%94/"},"url":"https://hyunhyun.github.io/posts/AWS-KMS-%EC%9D%B4%EC%9A%A9-%EC%95%94%ED%98%B8%ED%99%94/"}</script><title>AWS KMS 이용 암호화 | HyunHyun's BLOG</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/spring/mong.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">HyunHyun's BLOG</a></div><div class="site-subtitle font-italic">HyunHyun developer</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/hyunhyun" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>AWS KMS 이용 암호화</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>AWS KMS 이용 암호화</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Hyun </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Fri, Jul 21, 2023, 12:00 AM +0900" prep="on" > Jul 21 <i class="unloaded">2023-07-21T00:00:00+09:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Fri, Jul 21, 2023, 3:42 PM +0900" prefix="Updated " > Jul 21 <i class="unloaded">2023-07-21T15:42:08+09:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="470 words">2 min</span></div></div><div class="post-content"><h1 id="고객관리형키-kms-키로-암호화-적용">고객관리형키 KMS 키로 암호화 적용</h1><p>iam 사용자에 보안자격증명 탭에서 액세스 키 만들기를 선택한다. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://github.com/hyunhyun/hyunhyun.github.io/assets/18597515/28f279f9-1113-4091-91cb-812c168295a5" alt="액세스키생성 메뉴" /></p><p>aws cli 타입을 선택해서 하겠다. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://github.com/hyunhyun/hyunhyun.github.io/assets/18597515/48e3980c-5095-4b2c-8491-32856f1e4117" alt="액세스키 cli 선택" /></p><p>secret_access_key는 바로 별도로 저장해주어야한다. 이후에 조회가 불가하다. <img width="1064" alt="액세스키, 비번엑세스 가림" src="https://github.com/hyunhyun/hyunhyun.github.io/assets/18597515/664120fa-c045-4e57-92c2-cb555a936e5a" /></p><p>EC2에 aws cli를 통해 configure정보를 아래처럼 등록해준다. <img width="752" alt="aws cli configure설정" src="https://github.com/hyunhyun/hyunhyun.github.io/assets/18597515/74685e12-c1fe-438b-ae26-87d7f9e16af2" /></p><p>EC2에 AWSKeyManagementServicePowerUser를 추가해줍니다.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://github.com/hyunhyun/hyunhyun.github.io/assets/18597515/bb21d2eb-8947-452b-ba3e-96a82d85cfc3" alt="ec2 kms권한 추가" /></p><p>소스에 build.gradle에 아래와 같은 dependency를 추가한다.</p><div class="language-groovy highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>	<span class="c1">//aws</span>
	<span class="n">implementation</span> <span class="nf">platform</span><span class="o">(</span><span class="s1">'com.amazonaws:aws-java-sdk-bom:1.11.1000'</span><span class="o">)</span>
	<span class="n">compileOnly</span> <span class="nl">group:</span> <span class="s1">'com.amazonaws'</span><span class="o">,</span> <span class="nl">name:</span> <span class="s1">'aws-encryption-sdk-java'</span><span class="o">,</span> <span class="nl">version:</span> <span class="s1">'2.3.0'</span>
	<span class="n">implementation</span> <span class="nl">group:</span> <span class="s1">'com.amazonaws'</span><span class="o">,</span> <span class="nl">name:</span> <span class="s1">'aws-java-sdk-kms'</span><span class="o">,</span> <span class="nl">version:</span> <span class="s1">'1.12.475'</span>

	<span class="n">implementation</span> <span class="s1">'software.amazon.awssdk:regions:2.20.80'</span>
</pre></table></code></div></div><p>아래와 같은 코드를 추가하여 확인할 수 있도록 한다.</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>   <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/test/encrypt/{text}"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">encrypt</span><span class="o">(</span><span class="nd">@PathVariable</span> <span class="nc">String</span> <span class="n">text</span><span class="o">){</span>
        <span class="k">return</span> <span class="nc">KmsUtil</span><span class="o">.</span><span class="na">encrypt</span><span class="o">(</span><span class="n">text</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/test/encryptAndDecrypt/{text}"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">encryptAndDecrypt</span><span class="o">(</span><span class="nd">@PathVariable</span> <span class="nc">String</span> <span class="n">text</span><span class="o">){</span>
        <span class="nc">String</span> <span class="n">encrypt</span> <span class="o">=</span> <span class="nc">KmsUtil</span><span class="o">.</span><span class="na">encrypt</span><span class="o">(</span><span class="n">text</span><span class="o">);</span>
        <span class="nc">String</span> <span class="n">decrypt</span> <span class="o">=</span> <span class="nc">KmsUtil</span><span class="o">.</span><span class="na">decrypt</span><span class="o">(</span><span class="n">encrypt</span><span class="o">);</span>

        <span class="k">return</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="o">(</span><span class="s">"encrypt : "</span><span class="o">).</span><span class="na">append</span><span class="o">(</span><span class="n">encrypt</span><span class="o">).</span><span class="na">append</span><span class="o">(</span><span class="s">" decrypt : "</span><span class="o">).</span><span class="na">append</span><span class="o">(</span><span class="n">decrypt</span><span class="o">).</span><span class="na">toString</span><span class="o">();</span>
    <span class="o">}</span>
</pre></table></code></div></div><p>아래에 credentials는 profileCredentialProvider를 사용하였는데 <br /> 이를 사용하면 aws cli에 저장된 credentials 정보를 읽어온다. <br /> 암호화 알고리즘은 생성한 kms 키와 맞는 암호화 알고리즘을 작성해 주어야한다.</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre><span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">KEY_ID</span> <span class="o">=</span> <span class="s">"KMS 키 ID"</span><span class="o">;</span> <span class="c1">//KMS 암호활 할 키 (고객관리형키)</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="no">AWSKMS</span> <span class="n">awskms</span> <span class="o">=</span> <span class="nc">AWSKMSClientBuilder</span><span class="o">.</span><span class="na">standard</span><span class="o">().</span><span class="na">withRegion</span><span class="o">(</span><span class="nc">Regions</span><span class="o">.</span><span class="na">AP_NORTHEAST_2</span><span class="o">).</span><span class="na">build</span><span class="o">();</span>

    <span class="c1">//aws cli에 credentials 저장</span>
    <span class="kd">static</span> <span class="nc">AWSCredentialsProvider</span> <span class="n">awsCredentialsProvider</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ProfileCredentialsProvider</span><span class="o">();</span>

    <span class="c1">//kms 키의 암호화 알고리즘</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">EncryptionAlgorithmSpec</span> <span class="n">algorithmSpec</span> <span class="o">=</span> <span class="nc">EncryptionAlgorithmSpec</span><span class="o">.</span><span class="na">SYMMETRIC_DEFAULT</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="nf">encrypt</span><span class="o">(</span><span class="nc">String</span> <span class="n">plaintext</span><span class="o">){</span>
        <span class="nc">EncryptRequest</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">EncryptRequest</span><span class="o">();</span>
        <span class="n">request</span><span class="o">.</span><span class="na">withRequestCredentialsProvider</span><span class="o">(</span><span class="n">awsCredentialsProvider</span><span class="o">);</span>
        <span class="n">request</span><span class="o">.</span><span class="na">withKeyId</span><span class="o">(</span><span class="no">KEY_ID</span><span class="o">);</span>
        <span class="n">request</span><span class="o">.</span><span class="na">withPlaintext</span><span class="o">(</span><span class="nc">ByteBuffer</span><span class="o">.</span><span class="na">wrap</span><span class="o">(</span><span class="n">plaintext</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="nc">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">)));</span>
        <span class="n">request</span><span class="o">.</span><span class="na">withEncryptionAlgorithm</span><span class="o">(</span><span class="n">algorithmSpec</span><span class="o">);</span>

        <span class="nc">EncryptResult</span> <span class="n">result</span> <span class="o">=</span> <span class="n">awskms</span><span class="o">.</span><span class="na">encrypt</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
        <span class="nc">ByteBuffer</span> <span class="n">cipherTextBlob</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="na">getCiphertextBlob</span><span class="o">();</span>

        <span class="k">return</span> <span class="k">new</span> <span class="nf">String</span><span class="o">(</span><span class="nc">Base64</span><span class="o">.</span><span class="na">encodeBase64</span><span class="o">(</span><span class="n">cipherTextBlob</span><span class="o">.</span><span class="na">array</span><span class="o">()));</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="nf">decrypt</span><span class="o">(</span><span class="nc">String</span> <span class="n">encryptedText</span><span class="o">){</span>
        <span class="nc">DecryptRequest</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DecryptRequest</span><span class="o">();</span>
        <span class="n">request</span><span class="o">.</span><span class="na">withCiphertextBlob</span><span class="o">(</span><span class="nc">ByteBuffer</span><span class="o">.</span><span class="na">wrap</span><span class="o">(</span><span class="nc">Base64</span><span class="o">.</span><span class="na">decodeBase64</span><span class="o">(</span><span class="n">encryptedText</span><span class="o">)));</span>
        <span class="n">request</span><span class="o">.</span><span class="na">withRequestCredentialsProvider</span><span class="o">(</span><span class="n">awsCredentialsProvider</span><span class="o">);</span>
        <span class="n">request</span><span class="o">.</span><span class="na">withKeyId</span><span class="o">(</span><span class="no">KEY_ID</span><span class="o">);</span>
        <span class="n">request</span><span class="o">.</span><span class="na">withEncryptionAlgorithm</span><span class="o">(</span><span class="n">algorithmSpec</span><span class="o">);</span>

        <span class="nc">DecryptResult</span> <span class="n">result</span> <span class="o">=</span> <span class="n">awskms</span><span class="o">.</span><span class="na">decrypt</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">String</span><span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">getPlaintext</span><span class="o">().</span><span class="na">array</span><span class="o">());</span>
    <span class="o">}</span>
</pre></table></code></div></div><p>remote Repository에 push 하면 git commit에서 push를 인식하고 이전에 생성한 pipeline이 수행되어 아래와 같이 결과를 확인할 수 있다.</p><p><img width="1133" alt="encrypt결과확인" src="https://github.com/hyunhyun/hyunhyun.github.io/assets/18597515/0563c99d-3ece-49ab-a323-5731dd4917bb" /></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/aws/'>AWS</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/aws/" class="post-tag no-text-decoration" >AWS</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=AWS KMS 이용 암호화 - HyunHyun's BLOG&url=https://hyunhyun.github.io/posts/AWS-KMS-%EC%9D%B4%EC%9A%A9-%EC%95%94%ED%98%B8%ED%99%94/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=AWS KMS 이용 암호화 - HyunHyun's BLOG&u=https://hyunhyun.github.io/posts/AWS-KMS-%EC%9D%B4%EC%9A%A9-%EC%95%94%ED%98%B8%ED%99%94/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=AWS KMS 이용 암호화 - HyunHyun's BLOG&url=https://hyunhyun.github.io/posts/AWS-KMS-%EC%9D%B4%EC%9A%A9-%EC%95%94%ED%98%B8%ED%99%94/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/AWS-KMS-%EC%9D%B4%EC%9A%A9-%EC%95%94%ED%98%B8%ED%99%94/">AWS KMS 이용 암호화</a><li><a href="/posts/AWS-Code-deploy/">AWS Code deploy</a><li><a href="/posts/Code-Build-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0/">Code Build 사용하기</a><li><a href="/posts/gradle-profile-%EC%84%A4%EC%A0%95/">gradle profile 다르게 설정</a><li><a href="/posts/%EB%8B%A4%ED%98%95%EC%84%B1%EC%BF%BC%EB%A6%AC/">다형성 쿼리</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/jpa/">JPA</a> <a class="post-tag" href="/tags/spring/">Spring</a> <a class="post-tag" href="/tags/%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98/">알고리즘</a> <a class="post-tag" href="/tags/%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%A8%B8%EC%8A%A4/">프로그래머스</a> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/api/">API</a> <a class="post-tag" href="/tags/dynamicprogramming/">DynamicProgramming</a> <a class="post-tag" href="/tags/spring-boot-%EC%84%B8%ED%8C%85/">Spring boot 세팅</a> <a class="post-tag" href="/tags/swagger/">Swagger</a> <a class="post-tag" href="/tags/bfs/">BFS</a></div></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/AWS-RDS-%EC%95%94%ED%98%B8%EB%A1%9C-%EC%97%B0%EA%B2%B0/"><div class="card-body"> <span class="timeago small" > Jun 15 <i class="unloaded">2023-06-15T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>AWS RDS 암호로 연결</h3><div class="text-muted small"><p> AWS RDS 암호로 연결하기 AWS Aurora 생성 후 AWS에서 RDS 생성 시 암호를 직접 정해서 이를 이용해서 RDS에 연결 Secrets Manager를 이용해서 자동으로 암호를 생성해서 이를 AWS에서 안전하게 저장하고 이를 이용해서 연결 이렇게 방법으로 spring boot어플리케이션에서 aws rds에 접속하...</p></div></div></a></div><div class="card"> <a href="/posts/AWS-Code-Commit-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0/"><div class="card-body"> <span class="timeago small" > Jul 18 <i class="unloaded">2023-07-18T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>AWS Code Commit 사용하기</h3><div class="text-muted small"><p> Repository로 AWS Code Commit 사용하기 code commit 에서 리파지토리를 새로 생성해준다. iam 메뉴에 가서 사용자를 새로 생성한다. 사용자의 권한에 AWSCodeCommitFullAccess권한을 추가해준다. 사용자의 보안자격 증명 탭에 들어가면 아래에 AWS CodeCommit에 대한 HTTPS Git 자격 ...</p></div></div></a></div><div class="card"> <a href="/posts/AWS-Code-deploy/"><div class="card-body"> <span class="timeago small" > Jul 20 <i class="unloaded">2023-07-20T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>AWS Code deploy</h3><div class="text-muted small"><p> AWS code deploy code deploy를 생성하여 배포하는 과정을 만들어보겠다. code deploy에 들어가서 code deploy application을 생성한다. iam role 로 아래와 같이 AWSCodeDeployRole 권한이 있는 role을 생성한다. 아래와 같이 배포 그룹을 생성한다. 배포에 추가할 인스턴스 조합으...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Code-Build-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0/" class="btn btn-outline-primary" prompt="Older"><p>Code Build 사용하기</p></a> <span class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></span></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#main > div.row:first-child > div:first-child img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/username">Hyun</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/jpa/">JPA</a> <a class="post-tag" href="/tags/spring/">Spring</a> <a class="post-tag" href="/tags/%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98/">알고리즘</a> <a class="post-tag" href="/tags/%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%A8%B8%EC%8A%A4/">프로그래머스</a> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/api/">API</a> <a class="post-tag" href="/tags/dynamicprogramming/">DynamicProgramming</a> <a class="post-tag" href="/tags/spring-boot-%EC%84%B8%ED%8C%85/">Spring boot 세팅</a> <a class="post-tag" href="/tags/swagger/">Swagger</a> <a class="post-tag" href="/tags/bfs/">BFS</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://hyunhyun.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
